# Copyright: (c) 2019, Hetzner Cloud GmbH <info@hetzner-cloud.de>
# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)
---
- name: Test missing required parameters
  hetzner.hcloud.server:
    name: "{{ hcloud_server_name }}"
    state: present
  ignore_errors: true
  register: result
- name: Verify missing required parameters
  ansible.builtin.assert:
    that:
      - result is failed
      - >-
        result.msg == "missing required arguments: server_type, image"

- name: Test create server with invalid server type
  hetzner.hcloud.server:
    name: "{{ hcloud_server_name }}"
    server_type: invalid-server-type
    image: ubuntu-22.04
    state: present
  ignore_errors: true
  register: result
- name: Verify create server with invalid server type
  ansible.builtin.assert:
    that:
      - result is failed
      - >-
        result.msg == "Invalid server type ID `invalid-server-type`: server_type invalid-server-type was not found"

- name: Test create server with invalid image
  hetzner.hcloud.server:
    name: "{{ hcloud_server_name }}"
    server_type: cx11
    image: invalid-image
    state: present
  ignore_errors: true
  register: result
- name: Verify create server with invalid image
  ansible.builtin.assert:
    that:
      - result is failed
      - >-
        result.msg == "image with ID 'invalid-image' not found: Image invalid-image was not found"
